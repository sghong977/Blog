---
layout: post
title: Briefly review the code of deep feature 'DISK'
---

How can I custom COLMAP to use the other deep features? Currently I'm stuck into this, so I'll take a look at the way how DISK customize their output to COLMAP for the following SfM steps.




These days, I'm jumping in the deep end to get familiar with COLMAP and basics of multiview geometry.
I'm trying to use deep features (eg. LoFTR) to COLMAP but failed sparse reconstruction. I think it's because of the wrong usage of matches_importer.
And I find that Sitcoms3D do SfM using COLMAP and they also replace the basic SIFT features of colmap into 'DISK' feature.

So, things that I have to do in this step are:
- briefly see the concept of DISK feature algorithm
- input/output
- how to save and load feature in COLMAP


## concept of 'DISK' feature algorithm
.

## input/output
.

## how to save and load feature in COLMAP
See https://github.com/ethanweber/sitcoms3D/tree/master/external/disk.

Step1. Feature Extraction.
- python detect.py h5_artifacts_destination images_directory
- eg. python detect.py --height 1024 --width 1024 --n 2048 scene/h5 scene/images

Step2. Match Keypoints
- python match.py h5_artifacts_destination
- eg. python match.py --rt 0.95 --save-threshold 100 scene/h5

Step3. Convert to COLMAP *.db file
- features are inserted to db **without descriptor**.
- eg. python colmap/h5_to_db.py --database-path scene/database.db scene/h5 scene/images

Step4. execute colmap cli commands
- exhaustive_matcher and mapper (sparse reconstruction)

![image](https://user-images.githubusercontent.com/46152199/227842755-98eef01c-58f4-4dfe-8b62-b45adf6b03b8.png)

Then, let's check how to convert h5 to db file and insert my custom features like that.


(ing...)
